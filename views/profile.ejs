<%- include('components/header') %>
<div class="h-screen w-full bg-gray-100 flex flex-col">

  <!-- Profile Section -->
  <section class="w-full h-[30vh] flex flex-col items-center justify-center">
    <div class="w-[20vh] h-[20vh] rounded-full overflow-hidden mb-4 shadow">
      <img src="<%= currentUser.profilePicture || '/images/default.jpg' %>" alt="profile"
        class="w-full h-full object-cover">
    </div>
    <h1 class="font-bold text-2xl mb-1"><%= currentUser.FullName %></h1>
    <p class="text-sm text-gray-700">@<%= currentUser.username %></p>
  </section>

  <!-- Friends / Requests / Add Friends -->
  <section class="w-full h-[70vh] flex flex-row items-start justify-center gap-6 px-6">

    <!-- Friends -->
    <div class="flex-1 max-w-[60vh] h-full bg-gray-300 shadow-md rounded-lg p-4 flex flex-col">
      <h2 class="font-bold text-lg mb-3">Friends</h2>
      <div class="flex-1 bg-gray-100 p-3 rounded-2xl overflow-y-auto">
        <% if (currentUser.friends.length===0) { %>
          <p class="text-center text-gray-500 mt-3">No friends yet</p>
        <% } %>
        <% currentUser.friends.forEach(friend=> { %>
          <div class="flex justify-between items-center border-b py-2">
            <span><%= friend.FullName %></span>
            <form method="POST" action="/users/remove/<%= friend._id %>">
              <button type="submit" class="text-red-500 text-sm">Remove</button>
            </form>
          </div>
        <% }) %>
      </div>
    </div>

    <!-- Requests -->
    <div class="flex-1 max-w-[60vh] h-full bg-gray-300 shadow-md rounded-lg p-4 flex flex-col">
      <h2 class="font-bold text-lg mb-3">Requests</h2>
      <div class="flex-1 bg-gray-100 p-3 rounded-2xl overflow-y-auto">
        <% if (currentUser.requests.length===0) { %>
          <p class="text-center text-gray-500 mt-3">No requests</p>
        <% } %>
        <% currentUser.requests.forEach(reqUser=> { %>
          <div class="flex justify-between items-center border-b py-2">
            <span><%= reqUser.FullName %></span>
            <div class="flex gap-2">
              <form method="POST" action="/users/accept/<%= reqUser._id %>">
                <button type="submit" class="bg-blue-500 text-white px-3 py-1 rounded">Accept</button>
              </form>
              <form method="POST" action="/users/reject/<%= reqUser._id %>">
                <button type="submit" class="bg-red-500 text-white px-3 py-1 rounded">Reject</button>
              </form>
            </div>
          </div>
        <% }) %>
      </div>
    </div>

    <!-- Add Friends -->
    <div class="flex-1 max-w-[60vh] h-full bg-gray-300 shadow-md rounded-lg p-4 flex flex-col">
      <h2 class="font-bold text-lg mb-3">Add Friends</h2>
      <div class="flex-1 bg-gray-100 p-3 rounded-2xl overflow-y-auto">
        <% users.forEach(user=> { %>
          <div class="flex justify-between items-center border-b py-2">
            <span><%= user.FullName %> (@<%= user.username %>)</span>
            <form method="POST" action="/users/add/<%= user._id %>">
              <button type="submit" class="bg-green-500 text-white px-3 py-1 rounded">Add</button>
            </form>
          </div>
        <% }) %>
      </div>
    </div>

  </section>
</div>
<%- include('components/footer') %>
